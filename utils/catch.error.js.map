{"version":3,"sources":["../../src/utils/catch.error.ts"],"sourcesContent":["/* eslint-disable @typescript-eslint/no-unused-vars */\nimport {\n  Catch,\n  ExceptionFilter,\n  ArgumentsHost,\n  HttpException,\n  UnauthorizedException,\n  HttpStatus,\n} from '@nestjs/common';\nimport { Request, Response } from 'express';\nimport { ResultDto } from '../utils/result.dto';\n\n@Catch(UnauthorizedException)\nexport class UnauthorizedExceptionFilter implements ExceptionFilter {\n  catch(exception: UnauthorizedException, host: ArgumentsHost) {\n    const ctx = host.switchToHttp();\n    const response = ctx.getResponse<Response>();\n    const request = ctx.getRequest<Request>();\n    const status = HttpStatus.UNAUTHORIZED;\n    let errorMessage = null;\n    const responseData = exception.getResponse();\n    if (\n      typeof responseData === 'object' &&\n      responseData !== null &&\n      'message' in responseData\n    ) {\n      // 获取 message 属性的值\n      errorMessage = responseData.message;\n    } else {\n      // 处理 response 不是对象或没有 message 属性的情况\n      console.log(\n        'Response is not an object or does not contain a message property',\n      );\n    }\n    const result = new ResultDto(false, status, errorMessage);\n    response.status(status).json(result);\n  }\n}\n"],"names":["UnauthorizedExceptionFilter","catch","exception","host","ctx","switchToHttp","response","getResponse","request","getRequest","status","HttpStatus","UNAUTHORIZED","errorMessage","responseData","message","console","log","result","ResultDto","json","Catch","UnauthorizedException"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":"AAAA,oDAAoD;;;;+BAavCA;;;eAAAA;;;wBALN;2BAEmB;;;;;;;AAGnB,IAAA,AAAMA,8BAAN,MAAMA;IACXC,MAAMC,SAAgC,EAAEC,IAAmB,EAAE;QAC3D,MAAMC,MAAMD,KAAKE,YAAY;QAC7B,MAAMC,WAAWF,IAAIG,WAAW;QAChC,MAAMC,UAAUJ,IAAIK,UAAU;QAC9B,MAAMC,SAASC,kBAAU,CAACC,YAAY;QACtC,IAAIC,eAAe;QACnB,MAAMC,eAAeZ,UAAUK,WAAW;QAC1C,IACE,OAAOO,iBAAiB,YACxBA,iBAAiB,QACjB,aAAaA,cACb;YACA,kBAAkB;YAClBD,eAAeC,aAAaC,OAAO;QACrC,OAAO;YACL,oCAAoC;YACpCC,QAAQC,GAAG,CACT;QAEJ;QACA,MAAMC,SAAS,IAAIC,oBAAS,CAAC,OAAOT,QAAQG;QAC5CP,SAASI,MAAM,CAACA,QAAQU,IAAI,CAACF;IAC/B;AACF;AAxBalB;IADZqB,IAAAA,aAAK,EAACC,6BAAqB;GACftB"}